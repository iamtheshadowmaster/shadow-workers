---
import Layout from '../layouts/Layout.astro';
import Nav from '../components/Nav.astro';
import Footer from '../components/Footer.astro';

const faqs = [
  {
    question: "What is Shadow?",
    answer: "Shadow is an AI-powered productivity platform designed for modern achievers. We help top performers get more done by turning conversations into trackable tasks, organizing knowledge automatically, and streamlining workflows across your favorite tools."
  },
  {
    question: "How do I get started with Shadow?",
    answer: "To get started, join our waitlist by visiting the <a href='/apply' class='text-shadow-blue hover:underline'>application page</a>. Once you're accepted, you'll receive an email with instructions on how to set up your account and connect your tools."
  },
  {
    question: "What tools does Shadow integrate with?",
    answer: "Shadow integrates with popular productivity and communication tools including Slack, Notion, Asana, Trello, Salesforce, HubSpot, Google Workspace, Microsoft Teams, and many more. We're constantly adding new integrations based on user feedback."
  },
  {
    question: "Is my data secure with Shadow?",
    answer: "Absolutely. We take data security very seriously. All data is encrypted in transit and at rest, and we follow industry best practices for data protection. We never share your data with third parties, and you maintain full control over your information. Learn more in our <a href='/privacy' class='text-shadow-blue hover:underline'>privacy policy</a>."
  },
  {
    question: "What pricing plans do you offer?",
    answer: "We're currently in our early access phase and working with select customers to refine our offering. Pricing will be announced once we launch publicly. If you're on our waitlist, you'll be among the first to know about our pricing plans and any special early adopter offers."
  },
  {
    question: "Can I use Shadow for team collaboration?",
    answer: "Yes! Shadow is designed to work seamlessly for both individual productivity and team collaboration. You can share tasks, notes, and insights with your team members, and Shadow will help keep everyone aligned and on track."
  }
];
---

<Layout title="Support - Shadow">
  <Nav />
  <main class="min-h-screen bg-gradient-to-br from-gray-900 via-black to-gray-900">
    <div class="mx-auto max-w-4xl px-6 py-24 lg:py-32">

      <!-- Header -->
      <div class="text-center mb-20">
        <h1 class="text-4xl md:text-5xl lg:text-6xl font-bold text-white mb-6">
          Support
        </h1>
        <p class="text-lg md:text-xl text-gray-400">
          Get help and answers to common questions
        </p>
      </div>

      <!-- FAQ Section -->
      <div class="mb-32">
        <h2 class="text-2xl md:text-3xl font-bold text-white mb-10 text-center">
          Frequently Asked Questions
        </h2>

        <div class="space-y-4">
          {faqs.map((faq) => (
            <div class="faq-item bg-gray-800/30 backdrop-blur-sm rounded-xl border border-gray-700/50 overflow-hidden hover:border-gray-600/50 transition-all duration-200 cursor-pointer">
              <button class="faq-question w-full text-left px-6 md:px-8 py-6 flex justify-between items-start gap-6 cursor-pointer">
                <span class="text-base md:text-lg font-medium text-white flex-1">{faq.question}</span>
                <svg class="faq-icon w-5 h-5 text-gray-400 transition-transform duration-200 flex-shrink-0 mt-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                </svg>
              </button>
              <div class="faq-answer overflow-hidden transition-all duration-200 max-h-0">
                <div class="px-6 md:px-8 pb-6 pt-2">
                  <p class="text-gray-300 text-sm md:text-base leading-relaxed" set:html={faq.answer}></p>
                </div>
              </div>
            </div>
          ))}
        </div>
      </div>

      <!-- Contact Form Section -->
      <div class="mb-20">
        <div class="text-center mb-12">
          <h2 class="text-2xl md:text-3xl font-bold text-white mb-4">
            Still need help?
          </h2>
          <p class="text-gray-400">
            Send us a message and we'll get back to you within 24 hours
          </p>
        </div>

        <div class="bg-gray-800/30 backdrop-blur-sm rounded-xl border border-gray-700/50 p-8 md:p-10">
          <form id="supportForm" class="space-y-6">
            <!-- Name & Email Grid -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div>
                <label for="name" class="block text-sm font-medium text-gray-300 mb-2">
                  Name
                </label>
                <input
                  type="text"
                  name="name"
                  id="name"
                  required
                  placeholder="Your name"
                  class="block w-full rounded-lg border-0 bg-black/50 px-4 py-3 text-white placeholder:text-gray-500 focus:ring-2 focus:ring-white/20 transition-all sm:text-sm"
                />
              </div>

              <div>
                <label for="email" class="block text-sm font-medium text-gray-300 mb-2">
                  Email
                </label>
                <input
                  type="email"
                  name="email"
                  id="email"
                  required
                  placeholder="you@company.com"
                  class="block w-full rounded-lg border-0 bg-black/50 px-4 py-3 text-white placeholder:text-gray-500 focus:ring-2 focus:ring-white/20 transition-all sm:text-sm"
                />
              </div>
            </div>

            <!-- Subject -->
            <div>
              <label for="subject" class="block text-sm font-medium text-gray-300 mb-2">
                Subject
              </label>
              <select
                id="subject"
                name="subject"
                required
                class="block w-full rounded-lg border-0 bg-black/50 px-4 py-3 text-white focus:ring-2 focus:ring-white/20 transition-all sm:text-sm"
              >
                <option value="" class="bg-gray-900">Select a topic</option>
                <option value="General Inquiry" class="bg-gray-900">General Inquiry</option>
                <option value="Technical Support" class="bg-gray-900">Technical Support</option>
                <option value="Billing Question" class="bg-gray-900">Billing Question</option>
                <option value="Feature Request" class="bg-gray-900">Feature Request</option>
                <option value="Bug Report" class="bg-gray-900">Bug Report</option>
                <option value="Partnership Opportunity" class="bg-gray-900">Partnership Opportunity</option>
                <option value="Other" class="bg-gray-900">Other</option>
              </select>
            </div>

            <!-- Message -->
            <div>
              <label for="message" class="block text-sm font-medium text-gray-300 mb-2">
                Message
              </label>
              <textarea
                id="message"
                name="message"
                rows="6"
                required
                placeholder="Tell us how we can help..."
                class="block w-full rounded-lg border-0 bg-black/50 px-4 py-3 text-white placeholder:text-gray-500 focus:ring-2 focus:ring-white/20 transition-all sm:text-sm resize-none"
              ></textarea>
            </div>

            <!-- Urgent Checkbox -->
            <div class="flex items-center gap-3">
              <input
                id="urgent"
                name="urgent"
                type="checkbox"
                class="h-4 w-4 rounded border-gray-600 bg-gray-700 text-white focus:ring-white/20 focus:ring-offset-0 cursor-pointer"
              />
              <label for="urgent" class="text-sm text-gray-300 cursor-pointer">
                This is urgent
              </label>
            </div>

            <!-- Submit Button -->
            <div class="pt-4">
              <button
                type="submit"
                id="submitButton"
                class="w-full bg-white text-black px-6 py-3 rounded-lg font-semibold hover:bg-gray-100 transition-all duration-200 cursor-pointer"
              >
                Send Message
              </button>
            </div>

            <!-- Form Message -->
            <div id="formMessage" class="text-center text-sm min-h-[20px]"></div>
          </form>
        </div>
      </div>

    </div>
  </main>
  <Footer />
</Layout>

<style>
  .faq-item.open .faq-icon {
    transform: rotate(180deg);
  }

  .faq-item.open .faq-answer {
    max-height: 500px;
  }
</style>

<script>
  // FAQ Accordion functionality
  const faqItems = document.querySelectorAll('.faq-item');

  faqItems.forEach(item => {
    const question = item.querySelector('.faq-question');

    question?.addEventListener('click', () => {
      const isOpen = item.classList.contains('open');

      // Close all other FAQ items
      faqItems.forEach(otherItem => {
        if (otherItem !== item) {
          otherItem.classList.remove('open');
        }
      });

      // Toggle current item
      item.classList.toggle('open');
    });
  });

  // Contact Form submission
  const supportForm = document.getElementById('supportForm') as HTMLFormElement;
  const formMessage = document.getElementById('formMessage');
  const submitButton = document.getElementById('submitButton') as HTMLButtonElement;

  supportForm?.addEventListener('submit', async (e) => {
    e.preventDefault();

    if (!formMessage || !submitButton) return;

    // Update button state
    submitButton.disabled = true;
    submitButton.textContent = 'Sending...';

    formMessage.className = 'text-center text-sm text-gray-400 min-h-[20px]';
    formMessage.textContent = '';

    const formData = new FormData(supportForm);

    try {
      const response = await fetch('/api/support', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({
          name: formData.get('name')?.toString().trim() || '',
          email: formData.get('email')?.toString().trim() || '',
          subject: formData.get('subject')?.toString().trim() || '',
          message: formData.get('message')?.toString().trim() || '',
          urgent: formData.get('urgent') === 'on',
        }),
      });

      const data = await response.json();

      if (response.ok) {
        formMessage.className = 'text-center text-sm text-green-400 min-h-[20px]';
        formMessage.textContent = 'Message sent! We\'ll get back to you soon.';
        supportForm.reset();

        // Clear success message after 5 seconds
        setTimeout(() => {
          formMessage.textContent = '';
        }, 5000);
      } else {
        throw new Error(data.error || 'Failed to send message');
      }

    } catch (error) {
      console.error('Submission error:', error);
      formMessage.className = 'text-center text-sm text-red-400 min-h-[20px]';
      formMessage.textContent = error instanceof Error ? error.message : 'Something went wrong. Please try again.';
    } finally {
      // Reset button state
      submitButton.disabled = false;
      submitButton.textContent = 'Send Message';
    }
  });
</script>
