---
---

<section id="cta" class="py-40 bg-black border-t border-gray-900">
  <div class="max-w-4xl mx-auto px-6">

    <!-- CTA Section -->
    <div class="relative">
      <!-- Content -->
      <div class="flex flex-col items-center justify-center text-center">

        <!-- Title -->
        <div class="mb-16">
          <h2 class="text-5xl md:text-6xl font-bold text-white mb-8 leading-tight">
            Start hitting your goals.<br/>
            <span class="text-gray-400">No setup required.</span>
          </h2>
          <p class="text-xl text-gray-400 max-w-2xl mx-auto">
            Join thousands of managers and teams achieving more with less chaos.
          </p>
        </div>


        <!-- Content -->
        <div class="relative w-full max-w-2xl">
          <div class="backdrop-blur-sm rounded-2xl p-8">
            <!-- Form State -->
            <div id="signup-form" class="flex flex-col sm:flex-row gap-4 justify-center items-center max-w-lg mx-auto mb-6">
              <input
                id="email-input"
                type="email"
                placeholder="your@email.com"
                class="flex-1 px-6 py-4 bg-gray-900 border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-purple-500 focus:ring-2 focus:ring-purple-500/20 text-base"
              />
              <button id="signup-button" class="bg-white text-black px-8 py-4 rounded-lg font-semibold hover:bg-gray-100 hover:scale-105 transition-all duration-300 min-w-[200px] shadow-xl">
                <span id="cta-button-text" class="block text-center min-h-[1.25rem]">Start Free Trial</span>
              </button>
            </div>
            
            <!-- Success State (hidden by default) -->
            <div id="success-message" class="hidden text-center">
              <div class="bg-green-500/20 border border-green-500/30 rounded-lg p-6 mb-6">
                <div class="text-green-400 text-2xl mb-3">ðŸŽ‰</div>
                <h3 class="text-green-400 text-lg font-medium mb-2">You're in!</h3>
                <p class="text-green-300 text-sm">
                  Welcome to the waitlist. We'll keep you updated on our progress!
                </p>
              </div>
            </div>
            
            <!-- Error Message -->
            <div id="error-message" class="hidden text-center mb-4">
              <div class="bg-red-500/20 border border-red-500/30 rounded-lg p-4">
                <p class="text-red-400 text-sm" id="error-text"></p>
              </div>
            </div>


            <p id="form-subtitle" class="text-gray-500 text-sm text-center">
              No credit card required â€¢ 14-day free trial â€¢ Cancel anytime
            </p>
          </div>
        </div>

        <!-- Secondary CTA -->
        <div class="mt-8">
          <a href="#demo" class="text-gray-400 hover:text-white transition-colors text-sm underline">
            Or book a 15-minute demo with our team
          </a>
        </div>

      </div>
    </div>

  </div>
</section>

<script>
  const phrases = [
    "Start Free Trial",
    "Take back control",
    "Join 3,200+ managers",
    "Hit your goals",
    "Lead with confidence",
    "Transform your team"
  ];
  
  let currentPhraseIndex = 0;
  let currentCharIndex = 0;
  let isDeleting = false;
  
  const buttonText = document.getElementById('cta-button-text');
  const emailInput = document.getElementById('email-input') as HTMLInputElement;
  const signupButton = document.getElementById('signup-button') as HTMLButtonElement;
  const signupForm = document.getElementById('signup-form');
  const successMessage = document.getElementById('success-message');
  const errorMessage = document.getElementById('error-message');
  const errorText = document.getElementById('error-text');
  const formSubtitle = document.getElementById('form-subtitle');
  
  let isTypingAnimation = true;
  let typingTimeout: ReturnType<typeof setTimeout> | undefined;
  
  // Handle email input focus
  emailInput?.addEventListener('focus', () => {
    if (typingTimeout) clearTimeout(typingTimeout);
    isTypingAnimation = false;
    if (buttonText) buttonText.textContent = "Almost there...";
  });
  
  emailInput?.addEventListener('blur', () => {
    if (!emailInput.value.trim()) {
      isTypingAnimation = true;
      setTimeout(typeWriter, 500);
    }
  });
  
  function typeWriter() {
    if (!isTypingAnimation) return;
    if (!buttonText) return;
    
    const currentPhrase = phrases[currentPhraseIndex];
    
    if (isDeleting) {
      buttonText.textContent = currentPhrase.substring(0, currentCharIndex - 1);
      currentCharIndex--;
    } else {
      buttonText.textContent = currentPhrase.substring(0, currentCharIndex + 1);
      currentCharIndex++;
    }
    
    let speed = isDeleting ? 50 : 100;
    
    if (!isDeleting && currentCharIndex === currentPhrase.length) {
      speed = 2000; // Pause at the end
      isDeleting = true;
    } else if (isDeleting && currentCharIndex === 0) {
      isDeleting = false;
      currentPhraseIndex = (currentPhraseIndex + 1) % phrases.length;
      speed = 500; // Pause before starting new phrase
    }
    
    typingTimeout = setTimeout(typeWriter, speed);
  }
  
  // Form submission handler
  async function handleSignup() {
    const email = emailInput?.value?.trim();
    
    if (!email) {
      showError('Please enter your email address');
      return;
    }

    // Show loading state
    if (buttonText) buttonText.textContent = 'Joining...';
    if (signupButton) signupButton.disabled = true;
    hideError();

    try {
      const response = await fetch('/api/early-access', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ email }),
      });

      const data = await response.json();

      if (response.ok) {
        showSuccess();
      } else {
        showError(data.error || 'Something went wrong. Please try again.');
        resetButton();
      }
    } catch (error) {
      console.error('Signup error:', error);
      showError('Network error. Please check your connection and try again.');
      resetButton();
    }
  }

  function showSuccess() {
    if (signupForm) signupForm.style.display = 'none';
    if (successMessage) successMessage.classList.remove('hidden');
    if (formSubtitle) formSubtitle.style.display = 'none';
    isTypingAnimation = false;
    if (typingTimeout) clearTimeout(typingTimeout);
  }

  function showError(message: string) {
    if (errorText) errorText.textContent = message;
    if (errorMessage) errorMessage.classList.remove('hidden');
  }

  function hideError() {
    if (errorMessage) errorMessage.classList.add('hidden');
  }

  function resetButton() {
    if (signupButton) signupButton.disabled = false;
    if (emailInput && !emailInput.value.trim()) {
      isTypingAnimation = true;
      setTimeout(typeWriter, 500);
    } else {
      if (buttonText) buttonText.textContent = 'Almost there...';
    }
  }

  // Add click event listener to button
  signupButton?.addEventListener('click', handleSignup);

  // Add enter key support
  emailInput?.addEventListener('keypress', (e) => {
    if (e.key === 'Enter') {
      handleSignup();
    }
  });

  // Start the animation when the component loads
  setTimeout(typeWriter, 1000);
</script>
